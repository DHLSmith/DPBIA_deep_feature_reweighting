C:\deep_learning_project\DPBIA_deep_feature_reweighting\venv\Scripts\python.exe C:\deep_learning_project\DPBIA_deep_feature_reweighting\dfr_evaluate_spurious.py --data_dir=../data/waterbird_complete95_forest2water2/ --output_dir=RSLTS_DFR --ckpt_path=RSLTS_TC_2024-03-21_100243/final_checkpoint.pt --tune_class_weights_dfr_train
Preparing directory RSLTS_DFR_2024-03-22_115104
11788
4795
11788
5794
11788
1199
# Load model
C:\deep_learning_project\DPBIA_deep_feature_reweighting\venv\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\deep_learning_project\DPBIA_deep_feature_reweighting\venv\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
Base Model
100%|██████████| 58/58 [00:35<00:00,  1.63it/s]
100%|██████████| 12/12 [00:25<00:00,  2.10s/it]
100%|██████████| 48/48 [00:29<00:00,  1.62it/s]
  0%|          | 0/48 [00:00<?, ?it/s]{'test': {'accuracy_0_0': 0.9960088691796009, 'accuracy_0_1': 0.8527716186252772, 'accuracy_1_0': 0.7414330218068536, 'accuracy_1_1': 0.9641744548286605, 'mean_accuracy': 0.908526061442872, 'worst_accuracy': 0.7414330218068536}, 'val': {'accuracy_0_0': 0.9978586723768736, 'accuracy_0_1': 0.8347639484978541, 'accuracy_1_0': 0.6992481203007519, 'accuracy_1_1': 0.9548872180451128, 'mean_accuracy': 0.896580483736447, 'worst_accuracy': 0.6992481203007519}, 'train': {'accuracy_0_0': 1.0, 'accuracy_0_1': 1.0, 'accuracy_1_0': 1.0, 'accuracy_1_1': 1.0, 'mean_accuracy': 1.0, 'worst_accuracy': 1.0}}

100%|██████████| 48/48 [00:26<00:00,  1.83it/s]
100%|██████████| 58/58 [00:32<00:00,  1.79it/s]
100%|██████████| 12/12 [00:20<00:00,  1.69s/it]
DFR on validation
[66 66 66 66]
Hypers: (0.1, 1.0, 1.0)
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[2255 2255  642  642]
{'best_hypers': (0.1, 1.0, 1.0), 'test_accs': [0.952549889135255, 0.9175166297117516, 0.940809968847352, 0.9485981308411215], 'train_accs': [0.9548872180451128, 0.9548872180451128, 0.9699248120300752, 0.9548872180451128], 'test_worst_acc': 0.9175166297117516, 'test_mean_acc': 0.937176389368312}

DFR on train subsampled
dfr train subset_tune
[56 56 56 56]
1.0 {0: 1, 1: 1.0} 0.8648068669527897 [0.98072805 0.86480687 0.90977444 0.95488722]
1.0 {0: 1, 1: 2.0} 0.8154506437768241 [0.9764454  0.81545064 0.90977444 0.96240602]
1.0 {0: 1, 1: 3.0} 0.7982832618025751 [0.95931478 0.79828326 0.91729323 0.96992481]
1.0 {0: 1, 1: 10.0} 0.7446351931330472 [0.94860814 0.74463519 0.92481203 0.97744361]
1.0 {0: 1, 1: 100.0} 0.6351931330472103 [0.91006424 0.63519313 0.94736842 0.98496241]
1.0 {0: 1, 1: 300.0} 0.6244635193133047 [0.87794433 0.62446352 0.95488722 0.98496241]
1.0 {0: 1, 1: 1000.0} 0.5515021459227468 [0.84796574 0.55150215 0.94736842 0.9924812 ]
1.0 {0: 1.0, 1: 1} 0.8583690987124464 [0.98072805 0.8583691  0.91729323 0.95488722]
1.0 {0: 2.0, 1: 1} 0.8755364806866953 [0.98929336 0.87553648 0.90225564 0.95488722]
1.0 {0: 3.0, 1: 1} 0.8798283261802575 [0.99143469 0.87982833 0.88721805 0.95488722]
1.0 {0: 10.0, 1: 1} 0.8571428571428571 [0.99357602 0.90343348 0.85714286 0.93233083]
1.0 {0: 100.0, 1: 1} 0.8283261802575107 [0.97216274 0.82832618 0.93233083 0.95488722]
1.0 {0: 300.0, 1: 1} 0.7660944206008584 [0.9614561  0.76609442 0.94736842 0.96992481]
1.0 {0: 1000.0, 1: 1} 0.7896995708154506 [0.95503212 0.78969957 0.92481203 0.96240602]
0.7 {0: 1, 1: 1.0} 0.8583690987124464 [0.98072805 0.8583691  0.90225564 0.95488722]
0.7 {0: 1, 1: 2.0} 0.8068669527896996 [0.97002141 0.80686695 0.91729323 0.96240602]
0.7 {0: 1, 1: 3.0} 0.8068669527896996 [0.96359743 0.80686695 0.91729323 0.96240602]
0.7 {0: 1, 1: 10.0} 0.7639484978540773 [0.95931478 0.7639485  0.93984962 0.96992481]
0.7 {0: 1, 1: 100.0} 0.6330472103004292 [0.91648822 0.63304721 0.93984962 0.9924812 ]
0.7 {0: 1, 1: 300.0} 0.6244635193133047 [0.90364026 0.62446352 0.96240602 0.98496241]
0.7 {0: 1, 1: 1000.0} 0.5515021459227468 [0.875803   0.55150215 0.95488722 0.98496241]
0.7 {0: 1.0, 1: 1} 0.851931330472103 [0.9764454  0.85193133 0.91729323 0.95488722]
0.7 {0: 2.0, 1: 1} 0.8733905579399142 [0.99143469 0.87339056 0.89473684 0.95488722]
0.7 {0: 3.0, 1: 1} 0.8841201716738197 [0.99143469 0.88412017 0.88721805 0.94736842]
0.7 {0: 10.0, 1: 1} 0.849624060150376 [0.99571734 0.90987124 0.84962406 0.93233083]
0.7 {0: 100.0, 1: 1} 0.8390557939914163 [0.97430407 0.83905579 0.90977444 0.96240602]
0.7 {0: 300.0, 1: 1} 0.8133047210300429 [0.96573876 0.81330472 0.93233083 0.96240602]
0.7 {0: 1000.0, 1: 1} 0.7532188841201717 [0.9614561  0.75321888 0.93984962 0.96992481]
0.3 {0: 1, 1: 1.0} 0.8562231759656652 [0.97430407 0.85622318 0.91729323 0.94736842]
0.3 {0: 1, 1: 2.0} 0.8261802575107297 [0.96788009 0.82618026 0.91729323 0.96240602]
0.3 {0: 1, 1: 3.0} 0.8068669527896996 [0.95717345 0.80686695 0.91729323 0.96240602]
0.3 {0: 1, 1: 10.0} 0.7424892703862661 [0.94860814 0.74248927 0.93233083 0.96992481]
0.3 {0: 1, 1: 100.0} 0.648068669527897 [0.90364026 0.64806867 0.95488722 0.97744361]
0.3 {0: 1, 1: 300.0} 0.5815450643776824 [0.87794433 0.58154506 0.95488722 0.9924812 ]
0.3 {0: 1, 1: 1000.0} 0.5214592274678111 [0.88008565 0.52145923 0.96240602 0.9924812 ]
0.3 {0: 1.0, 1: 1} 0.8562231759656652 [0.97858672 0.85622318 0.91729323 0.94736842]
0.3 {0: 2.0, 1: 1} 0.8862660944206009 [0.98929336 0.88626609 0.90225564 0.93984962]
0.3 {0: 3.0, 1: 1} 0.8872180451127819 [0.99357602 0.89270386 0.88721805 0.93233083]
0.3 {0: 10.0, 1: 1} 0.849624060150376 [0.99571734 0.92703863 0.84962406 0.93233083]
0.3 {0: 100.0, 1: 1} 0.869098712446352 [0.9764454  0.86909871 0.91729323 0.95488722]
0.3 {0: 300.0, 1: 1} 0.8583690987124464 [0.9764454  0.8583691  0.90977444 0.95488722]
0.3 {0: 1000.0, 1: 1} 0.8197424892703863 [0.96359743 0.81974249 0.93233083 0.96240602]
0.1 {0: 1, 1: 1.0} 0.8454935622317596 [0.95503212 0.84549356 0.92481203 0.94736842]
0.1 {0: 1, 1: 2.0} 0.8047210300429185 [0.94860814 0.80472103 0.93984962 0.96240602]
0.1 {0: 1, 1: 3.0} 0.7703862660944206 [0.94432548 0.77038627 0.94736842 0.96240602]
0.1 {0: 1, 1: 10.0} 0.6845493562231759 [0.9143469  0.68454936 0.95488722 0.97744361]
0.1 {0: 1, 1: 100.0} 0.555793991416309 [0.875803   0.55579399 0.95488722 0.9924812 ]
0.1 {0: 1, 1: 300.0} 0.5450643776824035 [0.88008565 0.54506438 0.96240602 0.9924812 ]
0.1 {0: 1, 1: 1000.0} 0.4656652360515021 [0.83297645 0.46566524 0.96992481 0.9924812 ]
0.1 {0: 1.0, 1: 1} 0.8433476394849786 [0.95931478 0.84334764 0.92481203 0.93984962]
0.1 {0: 2.0, 1: 1} 0.9012875536480687 [0.98286938 0.90128755 0.90977444 0.92481203]
0.1 {0: 3.0, 1: 1} 0.8872180451127819 [0.99143469 0.91845494 0.88721805 0.92481203]
0.1 {0: 10.0, 1: 1} 0.8045112781954887 [0.99571734 0.93991416 0.80451128 0.92481203]
0.1 {0: 100.0, 1: 1} 0.7218045112781954 [0.99785867 0.96351931 0.72180451 0.90225564]
0.1 {0: 300.0, 1: 1} 0.8884120171673819 [0.97858672 0.88841202 0.90977444 0.94736842]
0.1 {0: 1000.0, 1: 1} 0.8433476394849786 [0.97430407 0.84334764 0.92481203 0.94736842]
0.07 {0: 1, 1: 1.0} 0.8304721030042919 [0.94432548 0.8304721  0.93233083 0.94736842]
0.07 {0: 1, 1: 2.0} 0.7811158798283262 [0.92719486 0.78111588 0.94736842 0.96240602]
0.07 {0: 1, 1: 3.0} 0.7381974248927039 [0.92505353 0.73819742 0.96240602 0.96240602]
0.07 {0: 1, 1: 10.0} 0.6609442060085837 [0.90149893 0.66094421 0.96240602 0.98496241]
0.07 {0: 1, 1: 100.0} 0.555793991416309 [0.89507495 0.55579399 0.96992481 0.9924812 ]
0.07 {0: 1, 1: 300.0} 0.4592274678111588 [0.8608137  0.45922747 0.96992481 0.9924812 ]
0.07 {0: 1, 1: 1000.0} 0.48497854077253216 [0.85224839 0.48497854 0.95488722 0.9924812 ]
0.07 {0: 1.0, 1: 1} 0.8240343347639485 [0.94432548 0.82403433 0.93233083 0.94736842]
0.07 {0: 2.0, 1: 1} 0.8948497854077253 [0.98286938 0.89484979 0.90977444 0.92481203]
0.07 {0: 3.0, 1: 1} 0.8796992481203008 [0.99143469 0.91630901 0.87969925 0.92481203]
0.07 {0: 10.0, 1: 1} 0.8120300751879699 [0.99785867 0.94849785 0.81203008 0.92481203]
0.07 {0: 100.0, 1: 1} 0.6766917293233082 [1.         0.96995708 0.67669173 0.88721805]
0.07 {0: 300.0, 1: 1} 0.8571428571428571 [0.99143469 0.93562232 0.85714286 0.92481203]
0.07 {0: 1000.0, 1: 1} 0.8175965665236051 [0.96788009 0.81759657 0.93233083 0.96240602]
0.03 {0: 1, 1: 1.0} 0.7532188841201717 [0.83511777 0.75321888 0.96240602 0.96992481]
0.03 {0: 1, 1: 2.0} 0.7553648068669528 [0.85653105 0.75536481 0.95488722 0.96240602]
0.03 {0: 1, 1: 3.0} 0.7446351931330472 [0.86723769 0.74463519 0.94736842 0.96992481]
0.03 {0: 1, 1: 10.0} 0.6759656652360515 [0.8993576  0.67596567 0.94736842 0.97744361]
0.03 {0: 1, 1: 100.0} 0.5493562231759657 [0.89293362 0.54935622 0.96240602 0.9924812 ]
0.03 {0: 1, 1: 300.0} 0.5450643776824035 [0.88865096 0.54506438 0.96240602 0.9924812 ]
0.03 {0: 1, 1: 1000.0} 0.4656652360515021 [0.89079229 0.46566524 0.96992481 0.9924812 ]
0.03 {0: 1.0, 1: 1} 0.7618025751072961 [0.83940043 0.76180258 0.96240602 0.96992481]
0.03 {0: 2.0, 1: 1} 0.8669527896995708 [0.95074946 0.86695279 0.91729323 0.93233083]
0.03 {0: 3.0, 1: 1} 0.8947368421052632 [0.98501071 0.91416309 0.89473684 0.92481203]
0.03 {0: 10.0, 1: 1} 0.7744360902255639 [0.99785867 0.96781116 0.77443609 0.88721805]
0.03 {0: 100.0, 1: 1} 0.5789473684210527 [1.         0.98712446 0.57894737 0.81203008]
0.03 {0: 300.0, 1: 1} 0.5112781954887218 [1.         0.98712446 0.5112782  0.78195489]
0.03 {0: 1000.0, 1: 1} 0.8819742489270386 [0.9764454  0.88197425 0.90977444 0.93984962]
0.01 {0: 1, 1: 1.0} 0.7832618025751072 [0.83083512 0.7832618  0.93233083 0.95488722]
0.01 {0: 1, 1: 2.0} 0.7725321888412017 [0.8608137  0.77253219 0.94736842 0.95488722]
0.01 {0: 1, 1: 3.0} 0.7618025751072961 [0.85653105 0.76180258 0.94736842 0.96992481]
0.01 {0: 1, 1: 10.0} 0.7381974248927039 [0.87794433 0.73819742 0.93984962 0.97744361]
0.01 {0: 1, 1: 100.0} 0.5321888412017167 [0.8993576  0.53218884 0.94736842 0.98496241]
0.01 {0: 1, 1: 300.0} 0.48283261802575106 [0.8993576  0.48283262 0.96240602 0.9924812 ]
0.01 {0: 1, 1: 1000.0} 0.48283261802575106 [0.86295503 0.48283262 0.95488722 0.9924812 ]
0.01 {0: 1.0, 1: 1} 0.7854077253218884 [0.83083512 0.78540773 0.93233083 0.95488722]
0.01 {0: 2.0, 1: 1} 0.708779443254818 [0.70877944 0.72103004 0.97744361 0.96240602]
0.01 {0: 3.0, 1: 1} 0.7339055793991416 [0.74089936 0.73390558 0.97744361 0.95488722]
0.01 {0: 10.0, 1: 1} 0.6541353383458647 [0.99785867 0.98283262 0.65413534 0.78195489]
0.01 {0: 100.0, 1: 1} 0.42857142857142855 [1.         0.99570815 0.42857143 0.56390977]
0.01 {0: 300.0, 1: 1} 0.3383458646616541 [1.         0.99785408 0.33834586 0.5037594 ]
0.01 {0: 1000.0, 1: 1} 0.3308270676691729 [1.         0.99785408 0.33082707 0.52631579]
Hypers: (0.1, 2.0, 1)
dfr train subset eval
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
{'best_hypers': (0.1, 2.0, 1), 'test_accs': [0.9694013303769401, 0.8878048780487805, 0.9252336448598131, 0.9579439252336449], 'train_accs': [1.0, 1.0, 1.0, 1.0], 'test_worst_acc': 0.8878048780487805, 'test_mean_acc': 0.9314808422506041}

{'base_model_results': {
'test': {'accuracy_0_0': 0.9960088691796009, 'accuracy_0_1': 0.8527716186252772, 'accuracy_1_0': 0.7414330218068536, 'accuracy_1_1': 0.9641744548286605, 'mean_accuracy': 0.908526061442872, 'worst_accuracy': 0.7414330218068536}, }
'val': {'accuracy_0_0': 0.9978586723768736, 'accuracy_0_1': 0.8347639484978541, 'accuracy_1_0': 0.6992481203007519, 'accuracy_1_1': 0.9548872180451128, 'mean_accuracy': 0.896580483736447, 'worst_accuracy': 0.6992481203007519},
'train': {'accuracy_0_0': 1.0, 'accuracy_0_1': 1.0, 'accuracy_1_0': 1.0, 'accuracy_1_1': 1.0, 'mean_accuracy': 1.0, 'worst_accuracy': 1.0}},
'dfr_val_results': {'best_hypers': (0.1, 1.0, 1.0), 'test_accs': [0.952549889135255, 0.9175166297117516, 0.940809968847352, 0.9485981308411215], 'train_accs': [0.9548872180451128, 0.9548872180451128, 0.9699248120300752, 0.9548872180451128], 'test_worst_acc': 0.9175166297117516, 'test_mean_acc': 0.937176389368312},
'dfr_train_results': {'best_hypers': (0.1, 2.0, 1), 'test_accs': [0.9694013303769401, 0.8878048780487805, 0.9252336448598131, 0.9579439252336449], 'train_accs': [1.0, 1.0, 1.0, 1.0], 'test_worst_acc': 0.8878048780487805, 'test_mean_acc': 0.9314808422506041}}

Process finished with exit code 0
