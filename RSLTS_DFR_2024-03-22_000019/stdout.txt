C:\deep_learning_project\DPBIA_deep_feature_reweighting\venv\Scripts\python.exe C:\deep_learning_project\DPBIA_deep_feature_reweighting\dfr_evaluate_spurious.py --data_dir=../data/waterbird_complete95_forest2water2/ --output_dir=RSLTS_DFR --ckpt_path=RSLTS_TC_2024-03-21_100243/final_checkpoint.pt --tune_class_weights_dfr_train
Preparing directory RSLTS_DFR_2024-03-22_000019
11788
4795
11788
5794
11788
1199
C:\deep_learning_project\DPBIA_deep_feature_reweighting\venv\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\deep_learning_project\DPBIA_deep_feature_reweighting\venv\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
Base Model
100%|██████████| 58/58 [00:39<00:00,  1.47it/s]
100%|██████████| 12/12 [00:21<00:00,  1.75s/it]
100%|██████████| 48/48 [00:30<00:00,  1.60it/s]
  0%|          | 0/48 [00:00<?, ?it/s]{'test': {'accuracy_0_0': 0.9960088691796009, 'accuracy_0_1': 0.8527716186252772, 'accuracy_1_0': 0.7414330218068536, 'accuracy_1_1': 0.9641744548286605, 'mean_accuracy': 0.908526061442872, 'worst_accuracy': 0.7414330218068536}, 'val': {'accuracy_0_0': 0.9978586723768736, 'accuracy_0_1': 0.8347639484978541, 'accuracy_1_0': 0.6992481203007519, 'accuracy_1_1': 0.9548872180451128, 'mean_accuracy': 0.896580483736447, 'worst_accuracy': 0.6992481203007519}, 'train': {'accuracy_0_0': 1.0, 'accuracy_0_1': 1.0, 'accuracy_1_0': 1.0, 'accuracy_1_1': 1.0, 'mean_accuracy': 1.0, 'worst_accuracy': 1.0}}

100%|██████████| 48/48 [00:26<00:00,  1.83it/s]
100%|██████████| 58/58 [00:27<00:00,  2.08it/s]
100%|██████████| 12/12 [00:24<00:00,  2.08s/it]
DFR on validation
[67 67 67 67]
Hypers: (0.03, 1.0, 1.0)
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[133 133 133 133]
[2255 2255  642  642]
{'best_hypers': (0.03, 1.0, 1.0), 'test_accs': [0.9250554323725055, 0.8824833702882483, 0.9485981308411215, 0.9532710280373832], 'train_accs': [0.9172932330827067, 0.8872180451127819, 0.9473684210526315, 0.9398496240601504], 'test_worst_acc': 0.8824833702882483, 'test_mean_acc': 0.9142216085605799}

DFR on train subsampled
[56 56 56 56]
1.0 {0: 1, 1: 1.0} 0.8605150214592274 [0.97858672 0.86051502 0.91729323 0.93984962]
1.0 {0: 1, 1: 2.0} 0.8326180257510729 [0.97002141 0.83261803 0.91729323 0.94736842]
1.0 {0: 1, 1: 3.0} 0.8068669527896996 [0.9614561  0.80686695 0.92481203 0.95488722]
1.0 {0: 1, 1: 10.0} 0.7618025751072961 [0.9614561  0.76180258 0.94736842 0.96992481]
1.0 {0: 1, 1: 100.0} 0.6416309012875536 [0.91220557 0.6416309  0.95488722 0.9924812 ]
1.0 {0: 1, 1: 300.0} 0.6072961373390557 [0.89293362 0.60729614 0.96992481 0.9924812 ]
1.0 {0: 1, 1: 1000.0} 0.572961373390558 [0.8608137  0.57296137 0.96240602 0.9924812 ]
1.0 {0: 1.0, 1: 1} 0.8605150214592274 [0.97430407 0.86051502 0.91729323 0.93984962]
1.0 {0: 2.0, 1: 1} 0.8755364806866953 [0.98072805 0.87553648 0.90977444 0.93233083]
1.0 {0: 3.0, 1: 1} 0.8798283261802575 [0.98286938 0.87982833 0.90977444 0.93233083]
1.0 {0: 10.0, 1: 1} 0.8991416309012875 [0.98072805 0.89914163 0.90225564 0.92481203]
1.0 {0: 100.0, 1: 1} 0.8433476394849786 [0.95074946 0.84334764 0.93233083 0.93233083]
1.0 {0: 300.0, 1: 1} 0.8175965665236051 [0.94004283 0.81759657 0.93233083 0.95488722]
1.0 {0: 1000.0, 1: 1} 0.7618025751072961 [0.93576017 0.76180258 0.93984962 0.95488722]
0.7 {0: 1, 1: 1.0} 0.8540772532188842 [0.97430407 0.85407725 0.91729323 0.95488722]
0.7 {0: 1, 1: 2.0} 0.8283261802575107 [0.96359743 0.82832618 0.91729323 0.96240602]
0.7 {0: 1, 1: 3.0} 0.796137339055794 [0.96788009 0.79613734 0.91729323 0.96240602]
0.7 {0: 1, 1: 10.0} 0.7510729613733905 [0.94432548 0.75107296 0.93984962 0.96992481]
0.7 {0: 1, 1: 100.0} 0.6545064377682404 [0.92719486 0.65450644 0.95488722 0.98496241]
0.7 {0: 1, 1: 300.0} 0.6459227467811158 [0.89293362 0.64592275 0.95488722 0.98496241]
0.7 {0: 1, 1: 1000.0} 0.5643776824034334 [0.85653105 0.56437768 0.96992481 0.98496241]
0.7 {0: 1.0, 1: 1} 0.8562231759656652 [0.96788009 0.85622318 0.91729323 0.93984962]
0.7 {0: 2.0, 1: 1} 0.8755364806866953 [0.98072805 0.87553648 0.91729323 0.93984962]
0.7 {0: 3.0, 1: 1} 0.8776824034334764 [0.98286938 0.8776824  0.89473684 0.93233083]
0.7 {0: 10.0, 1: 1} 0.8571428571428571 [0.98929336 0.91416309 0.85714286 0.92481203]
0.7 {0: 100.0, 1: 1} 0.8733905579399142 [0.95289079 0.87339056 0.91729323 0.93233083]
0.7 {0: 300.0, 1: 1} 0.8218884120171673 [0.93361884 0.82188841 0.94736842 0.94736842]
0.7 {0: 1000.0, 1: 1} 0.7639484978540773 [0.92933619 0.7639485  0.93984962 0.96992481]
0.3 {0: 1, 1: 1.0} 0.8540772532188842 [0.96359743 0.85407725 0.92481203 0.93233083]
0.3 {0: 1, 1: 2.0} 0.8197424892703863 [0.95289079 0.81974249 0.93984962 0.95488722]
0.3 {0: 1, 1: 3.0} 0.7854077253218884 [0.94860814 0.78540773 0.93984962 0.95488722]
0.3 {0: 1, 1: 10.0} 0.7360515021459227 [0.93576017 0.7360515  0.94736842 0.96992481]
0.3 {0: 1, 1: 100.0} 0.628755364806867 [0.90364026 0.62875536 0.96240602 0.98496241]
0.3 {0: 1, 1: 300.0} 0.5793991416309013 [0.87794433 0.57939914 0.96240602 0.9924812 ]
0.3 {0: 1, 1: 1000.0} 0.5472103004291845 [0.88008565 0.5472103  0.96240602 0.98496241]
0.3 {0: 1.0, 1: 1} 0.8390557939914163 [0.95931478 0.83905579 0.93233083 0.94736842]
0.3 {0: 2.0, 1: 1} 0.8776824034334764 [0.97858672 0.8776824  0.91729323 0.93233083]
0.3 {0: 3.0, 1: 1} 0.8776824034334764 [0.98286938 0.8776824  0.90225564 0.93984962]
0.3 {0: 10.0, 1: 1} 0.8571428571428571 [0.98929336 0.92060086 0.85714286 0.92481203]
0.3 {0: 100.0, 1: 1} 0.8947368421052632 [0.97002141 0.90343348 0.89473684 0.93233083]
0.3 {0: 300.0, 1: 1} 0.851931330472103 [0.94432548 0.85193133 0.92481203 0.93233083]
0.3 {0: 1000.0, 1: 1} 0.7939914163090128 [0.94218415 0.79399142 0.93984962 0.95488722]
0.1 {0: 1, 1: 1.0} 0.8154506437768241 [0.92719486 0.81545064 0.94736842 0.94736842]
0.1 {0: 1, 1: 2.0} 0.7832618025751072 [0.91648822 0.7832618  0.94736842 0.95488722]
0.1 {0: 1, 1: 3.0} 0.7339055793991416 [0.89079229 0.73390558 0.96240602 0.96992481]
0.1 {0: 1, 1: 10.0} 0.6802575107296137 [0.88008565 0.68025751 0.96240602 0.97744361]
0.1 {0: 1, 1: 100.0} 0.5815450643776824 [0.88436831 0.58154506 0.96240602 0.98496241]
0.1 {0: 1, 1: 300.0} 0.555793991416309 [0.88008565 0.55579399 0.96992481 0.9924812 ]
0.1 {0: 1, 1: 1000.0} 0.5128755364806867 [0.86295503 0.51287554 0.96240602 0.9924812 ]
0.1 {0: 1.0, 1: 1} 0.8197424892703863 [0.92719486 0.81974249 0.93984962 0.94736842]
0.1 {0: 2.0, 1: 1} 0.871244635193133 [0.96788009 0.87124464 0.92481203 0.93233083]
0.1 {0: 3.0, 1: 1} 0.9034334763948498 [0.97216274 0.90343348 0.90977444 0.93233083]
0.1 {0: 10.0, 1: 1} 0.8646616541353384 [0.98929336 0.93562232 0.86466165 0.92481203]
0.1 {0: 100.0, 1: 1} 0.8120300751879699 [0.98715203 0.95064378 0.81203008 0.90225564]
0.1 {0: 300.0, 1: 1} 0.871244635193133 [0.94432548 0.87124464 0.93984962 0.93984962]
0.1 {0: 1000.0, 1: 1} 0.8261802575107297 [0.94218415 0.82618026 0.91729323 0.93984962]
0.07 {0: 1, 1: 1.0} 0.7896995708154506 [0.89721627 0.78969957 0.96240602 0.94736842]
0.07 {0: 1, 1: 2.0} 0.7424892703862661 [0.86723769 0.74248927 0.98496241 0.96240602]
0.07 {0: 1, 1: 3.0} 0.7167381974248928 [0.8608137  0.7167382  0.96992481 0.96992481]
0.07 {0: 1, 1: 10.0} 0.6716738197424893 [0.89507495 0.67167382 0.96240602 0.97744361]
0.07 {0: 1, 1: 100.0} 0.5836909871244635 [0.88650964 0.58369099 0.96992481 0.98496241]
0.07 {0: 1, 1: 300.0} 0.5171673819742489 [0.88008565 0.51716738 0.95488722 0.9924812 ]
0.07 {0: 1, 1: 1000.0} 0.5536480686695279 [0.8608137  0.55364807 0.96992481 0.9924812 ]
0.07 {0: 1.0, 1: 1} 0.7939914163090128 [0.90364026 0.79399142 0.95488722 0.96240602]
0.07 {0: 2.0, 1: 1} 0.8669527896995708 [0.9614561  0.86695279 0.92481203 0.93233083]
0.07 {0: 3.0, 1: 1} 0.9120171673819742 [0.97430407 0.91201717 0.91729323 0.93233083]
0.07 {0: 10.0, 1: 1} 0.849624060150376 [0.99143469 0.93776824 0.84962406 0.92481203]
0.07 {0: 100.0, 1: 1} 0.6992481203007519 [0.99571734 0.96566524 0.69924812 0.88721805]
0.07 {0: 300.0, 1: 1} 0.8421052631578947 [0.97430407 0.95064378 0.84210526 0.91729323]
0.07 {0: 1000.0, 1: 1} 0.869098712446352 [0.9379015  0.86909871 0.91729323 0.93233083]
0.03 {0: 1, 1: 1.0} 0.7188841201716738 [0.81798715 0.71888412 0.98496241 0.96992481]
0.03 {0: 1, 1: 2.0} 0.723175965665236 [0.85224839 0.72317597 0.98496241 0.96992481]
0.03 {0: 1, 1: 3.0} 0.7167381974248928 [0.86723769 0.7167382  0.97744361 0.96992481]
0.03 {0: 1, 1: 10.0} 0.6909871244635193 [0.89079229 0.69098712 0.96992481 0.96992481]
0.03 {0: 1, 1: 100.0} 0.5321888412017167 [0.87366167 0.53218884 0.96992481 0.9924812 ]
0.03 {0: 1, 1: 300.0} 0.5472103004291845 [0.89293362 0.5472103  0.96240602 0.9924812 ]
0.03 {0: 1, 1: 1000.0} 0.4957081545064378 [0.88650964 0.49570815 0.96992481 0.9924812 ]
0.03 {0: 1.0, 1: 1} 0.7253218884120172 [0.81584582 0.72532189 0.98496241 0.96992481]
0.03 {0: 2.0, 1: 1} 0.8175965665236051 [0.91006424 0.81759657 0.93984962 0.94736842]
0.03 {0: 3.0, 1: 1} 0.8927038626609443 [0.94860814 0.89270386 0.93233083 0.93233083]
0.03 {0: 10.0, 1: 1} 0.8345864661654135 [0.99143469 0.94849785 0.83458647 0.91729323]
0.03 {0: 100.0, 1: 1} 0.6691729323308271 [1.         0.972103   0.66917293 0.87969925]
0.03 {0: 300.0, 1: 1} 0.5939849624060151 [1.         0.97854077 0.59398496 0.85714286]
0.03 {0: 1000.0, 1: 1} 0.8947368421052632 [0.95503212 0.91845494 0.89473684 0.92481203]
0.01 {0: 1, 1: 1.0} 0.703862660944206 [0.86723769 0.70386266 0.94736842 0.94736842]
0.01 {0: 1, 1: 2.0} 0.7124463519313304 [0.88008565 0.71244635 0.93984962 0.95488722]
0.01 {0: 1, 1: 3.0} 0.7274678111587983 [0.88222698 0.72746781 0.93984962 0.95488722]
0.01 {0: 1, 1: 10.0} 0.6974248927038627 [0.89507495 0.69742489 0.93984962 0.97744361]
0.01 {0: 1, 1: 100.0} 0.5364806866952789 [0.91006424 0.53648069 0.95488722 0.98496241]
0.01 {0: 1, 1: 300.0} 0.4871244635193133 [0.9143469  0.48712446 0.94736842 0.9924812 ]
0.01 {0: 1, 1: 1000.0} 0.41416309012875535 [0.85653105 0.41416309 0.96240602 0.9924812 ]
0.01 {0: 1.0, 1: 1} 0.703862660944206 [0.86723769 0.70386266 0.94736842 0.94736842]
0.01 {0: 2.0, 1: 1} 0.6723768736616702 [0.67237687 0.6888412  0.97744361 0.96240602]
0.01 {0: 3.0, 1: 1} 0.6852248394004282 [0.68522484 0.69313305 0.98496241 0.97744361]
0.01 {0: 10.0, 1: 1} 0.8045112781954887 [0.99357602 0.96351931 0.80451128 0.90225564]
0.01 {0: 100.0, 1: 1} 0.48872180451127817 [1.         0.99141631 0.4887218  0.65413534]
0.01 {0: 300.0, 1: 1} 0.42857142857142855 [1.         0.99570815 0.42857143 0.62406015]
0.01 {0: 1000.0, 1: 1} 0.6165413533834586 [0.99357602 0.98283262 0.61654135 0.79699248]
Hypers: (0.07, 3.0, 1)
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
[56 56 56 56]
{'best_hypers': (0.07, 3.0, 1), 'test_accs': [0.9827050997782705, 0.9188470066518847, 0.9127725856697819, 0.942367601246106], 'train_accs': [1.0, 1.0, 1.0, 1.0], 'test_worst_acc': 0.9127725856697819, 'test_mean_acc': 0.9456334138764239}

{'base_model_results': {
'test': {'accuracy_0_0': 0.9960088691796009, 'accuracy_0_1': 0.8527716186252772, 'accuracy_1_0': 0.7414330218068536, 'accuracy_1_1': 0.9641744548286605, 'mean_accuracy': 0.908526061442872, 'worst_accuracy': 0.7414330218068536},}
'val': {'accuracy_0_0': 0.9978586723768736, 'accuracy_0_1': 0.8347639484978541, 'accuracy_1_0': 0.6992481203007519, 'accuracy_1_1': 0.9548872180451128, 'mean_accuracy': 0.896580483736447, 'worst_accuracy': 0.6992481203007519},
'train': {'accuracy_0_0': 1.0, 'accuracy_0_1': 1.0, 'accuracy_1_0': 1.0, 'accuracy_1_1': 1.0, 'mean_accuracy': 1.0, 'worst_accuracy': 1.0}},
'dfr_val_results': {'best_hypers': (0.03, 1.0, 1.0), 'test_accs': [0.9250554323725055, 0.8824833702882483, 0.9485981308411215, 0.9532710280373832], 'train_accs': [0.9172932330827067, 0.8872180451127819, 0.9473684210526315, 0.9398496240601504], 'test_worst_acc': 0.8824833702882483, 'test_mean_acc': 0.9142216085605799},
'dfr_train_results': {'best_hypers': (0.07, 3.0, 1), 'test_accs': [0.9827050997782705, 0.9188470066518847, 0.9127725856697819, 0.942367601246106], 'train_accs': [1.0, 1.0, 1.0, 1.0], 'test_worst_acc': 0.9127725856697819, 'test_mean_acc': 0.9456334138764239}}

Process finished with exit code 0
